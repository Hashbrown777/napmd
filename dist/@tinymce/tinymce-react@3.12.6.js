define(["exports","react","prop-types"],(function(n,e,t){function o(n){if(n&&n.__esModule)return n;var e=Object.create(null);return n&&Object.keys(n).forEach((function(t){if("default"!==t){var o=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(e,t,o.get?o:{enumerable:!0,get:function(){return n[t]}})}})),e.default=n,Object.freeze(e)}var i,r,a=o(e),u=o(t),s=function(){return s=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n},s.apply(this,arguments)},c={onActivate:u.func,onAddUndo:u.func,onBeforeAddUndo:u.func,onBeforeExecCommand:u.func,onBeforeGetContent:u.func,onBeforeRenderUI:u.func,onBeforeSetContent:u.func,onBeforePaste:u.func,onBlur:u.func,onChange:u.func,onClearUndos:u.func,onClick:u.func,onContextMenu:u.func,onCopy:u.func,onCut:u.func,onDblclick:u.func,onDeactivate:u.func,onDirty:u.func,onDrag:u.func,onDragDrop:u.func,onDragEnd:u.func,onDragGesture:u.func,onDragOver:u.func,onDrop:u.func,onExecCommand:u.func,onFocus:u.func,onFocusIn:u.func,onFocusOut:u.func,onGetContent:u.func,onHide:u.func,onInit:u.func,onKeyDown:u.func,onKeyPress:u.func,onKeyUp:u.func,onLoadContent:u.func,onMouseDown:u.func,onMouseEnter:u.func,onMouseLeave:u.func,onMouseMove:u.func,onMouseOut:u.func,onMouseOver:u.func,onMouseUp:u.func,onNodeChange:u.func,onObjectResizeStart:u.func,onObjectResized:u.func,onObjectSelected:u.func,onPaste:u.func,onPostProcess:u.func,onPostRender:u.func,onPreProcess:u.func,onProgressState:u.func,onRedo:u.func,onRemove:u.func,onReset:u.func,onSaveContent:u.func,onSelectionChange:u.func,onSetAttrib:u.func,onSetContent:u.func,onShow:u.func,onSubmit:u.func,onUndo:u.func,onVisualAid:u.func},l=s({apiKey:u.string,id:u.string,inline:u.bool,init:u.object,initialValue:u.string,onEditorChange:u.func,outputFormat:u.oneOf(["html","text"]),value:u.string,tagName:u.string,cloudChannel:u.string,plugins:u.oneOfType([u.string,u.array]),toolbar:u.oneOfType([u.string,u.array]),disabled:u.bool,textareaName:u.string,tinymceScriptSrc:u.string,scriptLoading:u.shape({async:u.bool,defer:u.bool,delay:u.number})},c),d=function(n){return"function"==typeof n},f=function(n){return n in c},p=function(n){return n.substr(2)},h=function(n,e,t,o,i){return function(n,e,t,o,i,r,a){var u=Object.keys(i).filter(f),s=Object.keys(r).filter(f),c=u.filter((function(n){return void 0===r[n]})),l=s.filter((function(n){return void 0===i[n]}));c.forEach((function(n){var e=p(n),o=a[e];t(e,o),delete a[e]})),l.forEach((function(t){var i=o(n,t),r=p(t);a[r]=i,e(r,i)}))}(i,n.on.bind(n),n.off.bind(n),(function(e,t){return function(o){var i;return null===(i=e(t))||void 0===i?void 0:i(o,n)}}),e,t,o)},v=0,y=function(n){var e=Date.now();return n+"_"+Math.floor(1e9*Math.random())+ ++v+String(e)},g=function(n){return null!==n&&("textarea"===n.tagName.toLowerCase()||"input"===n.tagName.toLowerCase())},m=function(n){return void 0===n||""===n?[]:Array.isArray(n)?n:n.split(" ")},C=function(){return{listeners:[],scriptId:y("tiny-script"),scriptLoading:!1,scriptLoaded:!1}},b=(i=C(),{load:function(n,e,t,o,r,a){var u=function(){return function(n,e,t,o,i,r){var a=e.createElement("script");a.referrerPolicy="origin",a.type="application/javascript",a.id=n,a.src=t,a.async=o,a.defer=i;var u=function(){a.removeEventListener("load",u),r()};a.addEventListener("load",u),e.head&&e.head.appendChild(a)}(i.scriptId,n,e,t,o,(function(){i.listeners.forEach((function(n){return n()})),i.scriptLoaded=!0}))};i.scriptLoaded?a():(i.listeners.push(a),i.scriptLoading||(i.scriptLoading=!0,r>0?setTimeout(u,r):u()))},reinitialize:function(){i=C()}}),k=function(){return"undefined"!=typeof window?window:global},E=function(){var n=k();return n&&n.tinymce?n.tinymce:null},w=(r=function(n,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])},r(n,e)},function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}r(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}),S=function(){return S=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n},S.apply(this,arguments)},O=function(){var n,e,t;return(null===(t=null===(e=null===(n=E())||void 0===n?void 0:n.Env)||void 0===e?void 0:e.browser)||void 0===t?void 0:t.isIE())?"change keyup compositionend setcontent":"change input compositionend setcontent"},B=function(){return window.InputEvent&&"function"==typeof InputEvent.prototype.getTargetRanges?"beforeinput SelectionChange":"SelectionChange"},I=function(n){function e(e){var t,o,i,r=n.call(this,e)||this;return r.rollbackTimer=void 0,r.valueCursor=void 0,r.rollbackChange=function(){var n=r.editor,e=r.props.value;n&&e&&e!==r.currentContent&&n.undoManager.ignore((function(){if(n.setContent(e),r.valueCursor&&(!r.inline||n.hasFocus()))try{n.selection.moveToBookmark(r.valueCursor)}catch(n){}})),r.rollbackTimer=void 0},r.handleBeforeInput=function(n){if(void 0!==r.props.value&&r.props.value===r.currentContent&&r.editor&&(!r.inline||r.editor.hasFocus))try{r.valueCursor=r.editor.selection.getBookmark(3)}catch(n){}},r.handleBeforeInputSpecial=function(n){"Enter"!==n.key&&"Backspace"!==n.key&&"Delete"!==n.key||r.handleBeforeInput(n)},r.handleEditorChange=function(n){var e=r.editor;if(e&&e.initialized){var t=e.getContent();if(void 0!==r.props.value&&r.props.value!==t&&(r.rollbackTimer||(r.rollbackTimer=window.setTimeout(r.rollbackChange,200))),t!==r.currentContent&&(r.currentContent=t,d(r.props.onEditorChange))){var o=r.props.outputFormat,i="html"===o?t:e.getContent({format:o});r.props.onEditorChange(i,e)}}},r.handleEditorChangeSpecial=function(n){"Backspace"!==n.key&&"Delete"!==n.key||r.handleEditorChange(n)},r.initialise=function(n){var e,t,o;void 0===n&&(n=0);var i=r.elementRef.current;if(i)if(function(n){if(!("isConnected"in Node.prototype)){for(var e=n,t=n.parentNode;null!=t;)t=(e=t).parentNode;return e===n.ownerDocument}return n.isConnected}(i)){var a=E();if(!a)throw new Error("tinymce should have been loaded into global scope");var u,s,c=S(S({},r.props.init),{selector:void 0,target:i,readonly:r.props.disabled,inline:r.inline,plugins:(u=null===(e=r.props.init)||void 0===e?void 0:e.plugins,s=r.props.plugins,m(u).concat(m(s))),toolbar:null!==(t=r.props.toolbar)&&void 0!==t?t:null===(o=r.props.init)||void 0===o?void 0:o.toolbar,setup:function(n){r.editor=n,r.bindHandlers({}),r.inline&&!g(i)&&n.once("PostRender",(function(e){n.setContent(r.getInitialValue(),{no_events:!0})})),r.props.init&&d(r.props.init.setup)&&r.props.init.setup(n)},init_instance_callback:function(n){var e,t,o=r.getInitialValue();r.currentContent=null!==(e=r.currentContent)&&void 0!==e?e:n.getContent(),r.currentContent!==o&&(r.currentContent=o,n.setContent(o),n.undoManager.clear(),n.undoManager.add(),n.setDirty(!1));var i=null!==(t=r.props.disabled)&&void 0!==t&&t;n.setMode(i?"readonly":"design"),r.props.init&&d(r.props.init.init_instance_callback)&&r.props.init.init_instance_callback(n)}});r.inline||(i.style.visibility=""),g(i)&&(i.value=r.getInitialValue()),a.init(c)}else if(0===n)setTimeout((function(){return r.initialise(1)}),1);else{if(!(n<100))throw new Error("tinymce can only be initialised when in a document");setTimeout((function(){return r.initialise(n+1)}),100)}},r.id=r.props.id||y("tiny-react"),r.elementRef=a.createRef(),r.inline=null!==(i=null!==(t=r.props.inline)&&void 0!==t?t:null===(o=r.props.init)||void 0===o?void 0:o.inline)&&void 0!==i&&i,r.boundHandlers={},r}return w(e,n),e.prototype.componentDidUpdate=function(n){var e,t,o=this;if(this.rollbackTimer&&(clearTimeout(this.rollbackTimer),this.rollbackTimer=void 0),this.editor&&(this.bindHandlers(n),this.editor.initialized)){if(this.currentContent=null!==(e=this.currentContent)&&void 0!==e?e:this.editor.getContent(),"string"==typeof this.props.initialValue&&this.props.initialValue!==n.initialValue)this.editor.setContent(this.props.initialValue),this.editor.undoManager.clear(),this.editor.undoManager.add(),this.editor.setDirty(!1);else if("string"==typeof this.props.value&&this.props.value!==this.currentContent){var i=this.editor;i.undoManager.transact((function(){var n;if(!o.inline||i.hasFocus())try{n=i.selection.getBookmark(3)}catch(n){}var e=o.valueCursor;if(i.setContent(o.props.value),!o.inline||i.hasFocus())for(var t=0,r=[n,e];t<r.length;t++){var a=r[t];if(a)try{i.selection.moveToBookmark(a),o.valueCursor=a;break}catch(n){}}}))}if(this.props.disabled!==n.disabled){var r=null!==(t=this.props.disabled)&&void 0!==t&&t;this.editor.setMode(r?"readonly":"design")}}},e.prototype.componentDidMount=function(){var n,e,t,o,i,r;null!==E()?this.initialise():this.elementRef.current&&this.elementRef.current.ownerDocument&&b.load(this.elementRef.current.ownerDocument,this.getScriptSrc(),null!==(e=null===(n=this.props.scriptLoading)||void 0===n?void 0:n.async)&&void 0!==e&&e,null!==(o=null===(t=this.props.scriptLoading)||void 0===t?void 0:t.defer)&&void 0!==o&&o,null!==(r=null===(i=this.props.scriptLoading)||void 0===i?void 0:i.delay)&&void 0!==r?r:0,this.initialise)},e.prototype.componentWillUnmount=function(){var n=this,e=this.editor;e&&(e.off(O(),this.handleEditorChange),e.off(B(),this.handleBeforeInput),e.off("keypress",this.handleEditorChangeSpecial),e.off("keydown",this.handleBeforeInputSpecial),e.off("NewBlock",this.handleEditorChange),Object.keys(this.boundHandlers).forEach((function(t){e.off(t,n.boundHandlers[t])})),this.boundHandlers={},e.remove(),this.editor=void 0)},e.prototype.render=function(){return this.inline?this.renderInline():this.renderIframe()},e.prototype.renderInline=function(){var n=this.props.tagName,e=void 0===n?"div":n;return a.createElement(e,{ref:this.elementRef,id:this.id})},e.prototype.renderIframe=function(){return a.createElement("textarea",{ref:this.elementRef,style:{visibility:"hidden"},name:this.props.textareaName,id:this.id})},e.prototype.getScriptSrc=function(){if("string"==typeof this.props.tinymceScriptSrc)return this.props.tinymceScriptSrc;var n=this.props.cloudChannel;return"https://cdn.tiny.cloud/1/"+(this.props.apiKey?this.props.apiKey:"no-api-key")+"/tinymce/"+n+"/tinymce.min.js"},e.prototype.getInitialValue=function(){return"string"==typeof this.props.initialValue?this.props.initialValue:"string"==typeof this.props.value?this.props.value:""},e.prototype.bindHandlers=function(n){var e=this;if(void 0!==this.editor){h(this.editor,n,this.props,this.boundHandlers,(function(n){return e.props[n]}));var t=function(n){return void 0!==n.onEditorChange||void 0!==n.value},o=t(n),i=t(this.props);!o&&i?(this.editor.on(O(),this.handleEditorChange),this.editor.on(B(),this.handleBeforeInput),this.editor.on("keydown",this.handleBeforeInputSpecial),this.editor.on("keyup",this.handleEditorChangeSpecial),this.editor.on("NewBlock",this.handleEditorChange)):o&&!i&&(this.editor.off(O(),this.handleEditorChange),this.editor.off(B(),this.handleBeforeInput),this.editor.off("keydown",this.handleBeforeInputSpecial),this.editor.off("keyup",this.handleEditorChangeSpecial),this.editor.off("NewBlock",this.handleEditorChange))}},e.propTypes=l,e.defaultProps={cloudChannel:"5"},e}(a.Component);n.Editor=I,Object.defineProperty(n,"__esModule",{value:!0})}));
//# sourceMappingURL=tinymce-react@3.12.6.js.map
