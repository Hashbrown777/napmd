{"version":3,"file":"list-item.js","sources":["../../../../node_modules/mdast-util-to-hast/lib/handlers/list-item.js"],"sourcesContent":["/**\n * @typedef {import('mdast').ListItem} ListItem\n * @typedef {import('mdast').List} List\n * @typedef {import('hast').Properties} Properties\n * @typedef {import('hast').Element} Element\n * @typedef {import('../index.js').Handler} Handler\n * @typedef {import('../index.js').Content} Content\n */\n\nimport {u} from 'unist-builder'\nimport {all} from '../traverse.js'\n\n/**\n * @type {Handler}\n * @param {ListItem} node\n * @param {List} parent\n */\nexport function listItem(h, node, parent) {\n  const result = all(h, node)\n  const loose = parent ? listLoose(parent) : listItemLoose(node)\n  /** @type {Properties} */\n  const props = {}\n  /** @type {Array.<Content>} */\n  const wrapped = []\n\n  if (typeof node.checked === 'boolean') {\n    /** @type {Element} */\n    let paragraph\n\n    if (\n      result[0] &&\n      result[0].type === 'element' &&\n      result[0].tagName === 'p'\n    ) {\n      paragraph = result[0]\n    } else {\n      paragraph = h(null, 'p', [])\n      result.unshift(paragraph)\n    }\n\n    if (paragraph.children.length > 0) {\n      paragraph.children.unshift(u('text', ' '))\n    }\n\n    paragraph.children.unshift(\n      h(null, 'input', {\n        type: 'checkbox',\n        checked: node.checked,\n        disabled: true\n      })\n    )\n\n    // According to github-markdown-css, this class hides bullet.\n    // See: <https://github.com/sindresorhus/github-markdown-css>.\n    props.className = ['task-list-item']\n  }\n\n  let index = -1\n\n  while (++index < result.length) {\n    const child = result[index]\n\n    // Add eols before nodes, except if this is a loose, first paragraph.\n    if (\n      loose ||\n      index !== 0 ||\n      child.type !== 'element' ||\n      child.tagName !== 'p'\n    ) {\n      wrapped.push(u('text', '\\n'))\n    }\n\n    if (child.type === 'element' && child.tagName === 'p' && !loose) {\n      wrapped.push(...child.children)\n    } else {\n      wrapped.push(child)\n    }\n  }\n\n  const tail = result[result.length - 1]\n\n  // Add a final eol.\n  if (tail && (loose || !('tagName' in tail) || tail.tagName !== 'p')) {\n    wrapped.push(u('text', '\\n'))\n  }\n\n  return h(node, 'li', props, wrapped)\n}\n\n/**\n * @param {List} node\n * @return {Boolean}\n */\nfunction listLoose(node) {\n  let loose = node.spread\n  const children = node.children\n  let index = -1\n\n  while (!loose && ++index < children.length) {\n    loose = listItemLoose(children[index])\n  }\n\n  return Boolean(loose)\n}\n\n/**\n * @param {ListItem} node\n * @return {Boolean}\n */\nfunction listItemLoose(node) {\n  const spread = node.spread\n\n  return spread === undefined || spread === null\n    ? node.children.length > 1\n    : spread\n}\n"],"names":["listItemLoose","node","spread","children","length","h","parent","result","all","loose","index","Boolean","listLoose","props","wrapped","checked","paragraph","type","tagName","unshift","u","disabled","className","child","push","tail"],"mappings":"kEA6GA,SAASA,EAAcC,GACrB,MAAMC,EAASD,EAAKC,OAEpB,OAAOA,MAAAA,EACHD,EAAKE,SAASC,OAAS,EACvBF,aAjGC,SAAkBG,EAAGJ,EAAMK,GAChC,MAAMC,EAASC,MAAIH,EAAGJ,GAChBQ,EAAQH,EA0EhB,SAAmBL,GACjB,IAAIQ,EAAQR,EAAKC,OACjB,MAAMC,EAAWF,EAAKE,SACtB,IAAIO,GAAS,EAEb,MAAQD,KAAWC,EAAQP,EAASC,QAClCK,EAAQT,EAAcG,EAASO,IAGjC,OAAOC,QAAQF,GAnFQG,CAAUN,GAAUN,EAAcC,GAEnDY,EAAQ,GAERC,EAAU,GAEhB,GAA4B,kBAAjBb,EAAKc,QAAuB,CAErC,IAAIC,EAGFT,EAAO,IACY,YAAnBA,EAAO,GAAGU,MACY,MAAtBV,EAAO,GAAGW,QAEVF,EAAYT,EAAO,IAEnBS,EAAYX,EAAE,KAAM,IAAK,IACzBE,EAAOY,QAAQH,IAGbA,EAAUb,SAASC,OAAS,GAC9BY,EAAUb,SAASgB,QAAQC,IAAE,OAAQ,MAGvCJ,EAAUb,SAASgB,QACjBd,EAAE,KAAM,QAAS,CACfY,KAAM,WACNF,QAASd,EAAKc,QACdM,UAAU,KAMdR,EAAMS,UAAY,CAAC,kBAGrB,IAAIZ,GAAS,EAEb,OAASA,EAAQH,EAAOH,QAAQ,CAC9B,MAAMmB,EAAQhB,EAAOG,IAInBD,GACU,IAAVC,GACe,YAAfa,EAAMN,MACY,MAAlBM,EAAML,UAENJ,EAAQU,KAAKJ,IAAE,OAAQ,OAGN,YAAfG,EAAMN,MAAwC,MAAlBM,EAAML,SAAoBT,EAGxDK,EAAQU,KAAKD,GAFbT,EAAQU,QAAQD,EAAMpB,UAM1B,MAAMsB,EAAOlB,EAAOA,EAAOH,OAAS,GAOpC,OAJIqB,IAAShB,GAAW,YAAagB,GAA0B,MAAjBA,EAAKP,SACjDJ,EAAQU,KAAKJ,IAAE,OAAQ,OAGlBf,EAAEJ,EAAM,KAAMY,EAAOC"}