{"version":3,"file":"footer.js","sources":["../../../node_modules/mdast-util-to-hast/lib/footer.js"],"sourcesContent":["/**\n * @typedef {import('mdast').BlockContent} BlockContent\n * @typedef {import('mdast').FootnoteDefinition} FootnoteDefinition\n * @typedef {import('mdast').Link} Link\n * @typedef {import('mdast').ListItem} ListItem\n * @typedef {import('mdast').Paragraph} Paragraph\n * @typedef {import('./index.js').H} H\n */\n\nimport {thematicBreak} from './handlers/thematic-break.js'\nimport {list} from './handlers/list.js'\nimport {wrap} from './wrap.js'\n\n/**\n * @param {H} h\n */\nexport function footer(h) {\n  const footnoteById = h.footnoteById\n  const footnoteOrder = h.footnoteOrder\n  let index = -1\n  /** @type {Array.<ListItem>} */\n  const listItems = []\n\n  while (++index < footnoteOrder.length) {\n    const def = footnoteById[footnoteOrder[index].toUpperCase()]\n\n    if (!def) {\n      continue\n    }\n\n    const marker = String(index + 1)\n    const content = [...def.children]\n    /** @type {Link} */\n    const backReference = {\n      type: 'link',\n      url: '#fnref' + marker,\n      data: {hProperties: {className: ['footnote-back'], role: 'doc-backlink'}},\n      children: [{type: 'text', value: '↩'}]\n    }\n    const tail = content[content.length - 1]\n\n    if (tail && tail.type === 'paragraph') {\n      tail.children.push(backReference)\n    } else {\n      // @ts-expect-error Indeed, link directly added in block content.\n      // Which we do because that way at least the handlers will be called\n      // for the other HTML we’re generating (as markdown).\n      content.push(backReference)\n    }\n\n    listItems.push({\n      type: 'listItem',\n      data: {hProperties: {id: 'fn' + marker, role: 'doc-endnote'}},\n      children: content,\n      position: def.position\n    })\n  }\n\n  if (listItems.length === 0) {\n    return null\n  }\n\n  return h(\n    null,\n    'section',\n    {className: ['footnotes'], role: 'doc-endnotes'},\n    wrap(\n      [\n        thematicBreak(h),\n        list(h, {type: 'list', ordered: true, children: listItems})\n      ],\n      true\n    )\n  )\n}\n"],"names":["h","footnoteById","footnoteOrder","index","listItems","length","def","toUpperCase","marker","String","content","children","backReference","type","url","data","hProperties","className","role","value","tail","push","id","position","wrap","thematicBreak","list","ordered"],"mappings":"uIAgBO,SAAgBA,GACrB,MAAMC,EAAeD,EAAEC,aACjBC,EAAgBF,EAAEE,cACxB,IAAIC,GAAS,EAEb,MAAMC,EAAY,GAElB,OAASD,EAAQD,EAAcG,QAAQ,CACrC,MAAMC,EAAML,EAAaC,EAAcC,GAAOI,eAE9C,IAAKD,EACH,SAGF,MAAME,EAASC,OAAON,EAAQ,GACxBO,EAAU,IAAIJ,EAAIK,UAElBC,EAAgB,CACpBC,KAAM,OACNC,IAAK,SAAWN,EAChBO,KAAM,CAACC,YAAa,CAACC,UAAW,CAAC,iBAAkBC,KAAM,iBACzDP,SAAU,CAAC,CAACE,KAAM,OAAQM,MAAO,OAE7BC,EAAOV,EAAQA,EAAQL,OAAS,GAElCe,GAAsB,cAAdA,EAAKP,KACfO,EAAKT,SAASU,KAAKT,GAKnBF,EAAQW,KAAKT,GAGfR,EAAUiB,KAAK,CACbR,KAAM,WACNE,KAAM,CAACC,YAAa,CAACM,GAAI,KAAOd,EAAQU,KAAM,gBAC9CP,SAAUD,EACVa,SAAUjB,EAAIiB,WAIlB,OAAyB,IAArBnB,EAAUC,OACL,KAGFL,EACL,KACA,UACA,CAACiB,UAAW,CAAC,aAAcC,KAAM,gBACjCM,OACE,CACEC,gBAAczB,GACd0B,OAAK1B,EAAG,CAACa,KAAM,OAAQc,SAAS,EAAMhB,SAAUP,MAElD"}