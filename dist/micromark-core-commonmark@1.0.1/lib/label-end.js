define(["exports","micromark-factory-destination","micromark-factory-label","micromark-factory-title","micromark-factory-whitespace","micromark-util-character","micromark-util-chunked","micromark-util-normalize-identifier","micromark-util-resolve-all"],(function(e,r,t,n,i,a,c,l,s){const o={name:"labelEnd",tokenize:function(e,r,t){const n=this;let i,a,c=n.events.length;for(;c--;)if(("labelImage"===n.events[c][1].type||"labelLink"===n.events[c][1].type)&&!n.events[c][1]._balanced){i=n.events[c][1];break}return function(r){if(!i)return t(r);return i._inactive?o(r):(a=n.parser.defined.includes(l.normalizeIdentifier(n.sliceSerialize({start:i.end,end:n.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(r),e.exit("labelMarker"),e.exit("labelEnd"),s)};function s(t){return 40===t?e.attempt(u,r,a?r:o)(t):91===t?e.attempt(f,r,a?e.attempt(p,r,o):o)(t):a?r(t):o(t)}function o(e){return i._balanced=!0,t(e)}},resolveTo:function(e,r){let t,n,i,a,l=e.length,o=0;for(;l--;)if(t=e[l][1],n){if("link"===t.type||"labelLink"===t.type&&t._inactive)break;"enter"===e[l][0]&&"labelLink"===t.type&&(t._inactive=!0)}else if(i){if("enter"===e[l][0]&&("labelImage"===t.type||"labelLink"===t.type)&&!t._balanced&&(n=l,"labelLink"!==t.type)){o=2;break}}else"labelEnd"===t.type&&(i=l);const u={type:"labelLink"===e[n][1].type?"link":"image",start:Object.assign({},e[n][1].start),end:Object.assign({},e[e.length-1][1].end)},f={type:"label",start:Object.assign({},e[n][1].start),end:Object.assign({},e[i][1].end)},p={type:"labelText",start:Object.assign({},e[n+o+2][1].end),end:Object.assign({},e[i-2][1].start)};return a=[["enter",u,r],["enter",f,r]],a=c.push(a,e.slice(n+1,n+o+3)),a=c.push(a,[["enter",p,r]]),a=c.push(a,s.resolveAll(r.parser.constructs.insideSpan.null,e.slice(n+o+4,i-3),r)),a=c.push(a,[["exit",p,r],e[i-2],e[i-1],["exit",f,r]]),a=c.push(a,e.slice(i+1)),a=c.push(a,[["exit",u,r]]),c.splice(e,n,e.length,a),e},resolveAll:function(e){let r,t=-1;for(;++t<e.length;)r=e[t][1],"labelImage"!==r.type&&"labelLink"!==r.type&&"labelEnd"!==r.type||(e.splice(t+1,"labelImage"===r.type?4:2),r.type="data",t++);return e}},u={tokenize:function(e,t,c){return function(r){return e.enter("resource"),e.enter("resourceMarker"),e.consume(r),e.exit("resourceMarker"),i.factoryWhitespace(e,l)};function l(t){return 41===t?u(t):r.factoryDestination(e,s,c,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",3)(t)}function s(r){return a.markdownLineEndingOrSpace(r)?i.factoryWhitespace(e,o)(r):u(r)}function o(r){return 34===r||39===r||40===r?n.factoryTitle(e,i.factoryWhitespace(e,u),c,"resourceTitle","resourceTitleMarker","resourceTitleString")(r):u(r)}function u(r){return 41===r?(e.enter("resourceMarker"),e.consume(r),e.exit("resourceMarker"),e.exit("resource"),t):c(r)}}},f={tokenize:function(e,r,n){const i=this;return function(r){return t.factoryLabel.call(i,e,a,n,"reference","referenceMarker","referenceString")(r)};function a(e){return i.parser.defined.includes(l.normalizeIdentifier(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?r(e):n(e)}}},p={tokenize:function(e,r,t){return function(r){return e.enter("reference"),e.enter("referenceMarker"),e.consume(r),e.exit("referenceMarker"),n};function n(n){return 93===n?(e.enter("referenceMarker"),e.consume(n),e.exit("referenceMarker"),e.exit("reference"),r):t(n)}}};e.labelEnd=o,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=label-end.js.map
